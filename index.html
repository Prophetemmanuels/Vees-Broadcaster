<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vees Thrift Broadcaster</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#f6c1d9">

<style>
body{font-family:Arial;margin:0;padding:15px;background:#fff}
h2{text-align:center}
input,select,button{width:100%;padding:12px;margin:6px 0;border-radius:8px;border:1px solid #ccc;font-size:16px}
button{background:#25D366;color:#fff;border:none;font-weight:bold}
.product{border:1px solid #ddd;padding:8px;margin:8px 0;border-radius:10px}
img{max-width:100%;border-radius:8px;margin-top:5px}
</style>
</head>
<body>

<h2>Vees Thrift Product Sender</h2>

<input type="text" id="pname" placeholder="Product Name">
<input type="text" id="psize" placeholder="Size (number, letter, or anything)">
<input type="number" id="pprice" placeholder="Price">

<select id="pcurrency">
  <option value="ZMW" selected>ZMW</option>
  <option value="ZMK">ZMK</option>
  <option value="$">USD</option>
  <option value="â‚¬">EUR</option>
</select>

<!-- IMAGE INPUTS -->
<input type="file" id="cameraInput" accept="image/*" capture="environment" hidden>
<input type="file" id="galleryInput" accept="image/*" hidden>

<button type="button" onclick="openCamera()">ðŸ“· Take Photo</button>
<button type="button" onclick="openGallery()">ðŸ–¼ Upload from Gallery</button>

<img id="preview" style="display:none">

<button onclick="addProduct()">âž• Add Product</button>

<div id="productList"></div>

<button onclick="sendToWhatsApp()">ðŸš€ Send Products to WhatsApp Group</button>

<script>
let products = [];
let selectedImage = "";

// Time display
function updateTime(){
  const now=new Date();
  if(document.getElementById("datetime"))
    document.getElementById("datetime").innerText=now.toLocaleDateString()+" | "+now.toLocaleTimeString();
}
setInterval(updateTime,1000); updateTime();

// Camera & Gallery
function openCamera(){ cameraInput.click(); }
function openGallery(){ galleryInput.click(); }

cameraInput.onchange = handleImage;
galleryInput.onchange = handleImage;

function handleImage(e){
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(ev){
    selectedImage = ev.target.result;
    const preview = document.getElementById("preview");
    preview.src = selectedImage;
    preview.style.display = "block";
  }
  reader.readAsDataURL(file);
}

// Add product
function addProduct(){
  const name = pname.value.trim();
  const size = psize.value.trim();
  const price = pprice.value.trim();
  const currency = document.getElementById("pcurrency").value;

  if(!name || !size || !price || !selectedImage){
    alert("Fill all fields & choose image");
    return;
  }

  const now = new Date();
  const product = {
    name, size, price, currency,
    image: selectedImage,
    date: now.toLocaleDateString(),
    time: now.toLocaleTimeString()
  };

  products.push(product);
  displayProducts();

  // reset fields
  pname.value=""; psize.value=""; pprice.value="";
  preview.style.display="none"; selectedImage="";
}

// Display product list
function displayProducts(){
  const list = document.getElementById("productList");
  list.innerHTML="";
  products.forEach((p,i)=>{
    list.innerHTML+=`
      <div class="product">
        <b>${p.name}</b><br>
        Size: ${p.size}<br>
        Price: ${p.price} ${p.currency}<br>
        Date: ${p.date} ${p.time}
        <img src="${p.image}">
      </div>`;
  });
}

// Send to WhatsApp
function sendToWhatsApp(){
  if(products.length===0){ alert("No products added"); return; }

  let text="ðŸ›ï¸ *Vees Thrift Products* ðŸ›ï¸%0A%0A";
  products.forEach((p,i)=>{
    text+=`${i+1}. *${p.name}*%0ASize: ${p.size}%0APrice: ${p.price} ${p.currency}%0ADate: ${p.date} ${p.time}%0A%0A`;
  });

  window.open(`https://wa.me/?text=${text}`,"_blank");
}

// Service Worker
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('service-worker.js');
}
</script>

</body>
</html>
